service: driverconnect-app 

image: ms3347/driverconnect-app


servers:

  web:

    hosts:

      - 157.180.87.7

    

   

proxy:
  ssl: true
  hosts:
    - "onestopvan.work.gd"
  app_port: 5001  
  healthcheck:
    path: /api/health
    interval: 10
    timeout: 5  


env:

  clear:

    ASPNETCORE_ENVIRONMENT: Production

    ASPNETCORE_URLS: "http://+:5001"

    ConnectionStrings__DefaultConnection: "Data Source=/app/data/DriverConnect.db"

  secret:

    - WhatsApp__AccessToken

    - WhatsApp__PhoneNumberId

    - WhatsApp__VerifyToken

    - KAMAL_REGISTRY_PASSWORD

    - SmtpSettings__Password


volumes:

  - "/var/lib/driverconnect/data:/app/data"

  - "/var/lib/driverconnect/uploads:/app/uploads"


builder:

  context: .

  dockerfile: Dockerfile  # Changed to root Dockerfile

  arch: arm64 


registry:

  username: ms3347

  password:

    - KAMAL_REGISTRY_PASSWORD


boot:

  limit: 30

  wait: 2


